{%extends "dashboard.html"%}
{%block content%}
<br><br>
<div class="container">
    <form action="/validateCoupon" method="POST">
        {%csrf_token%}
        <div class="row">
            <div class="col-sm-7 form-group">
                <label for="option">Select Appropriate Search Option</label>
                <select name="option" id="option" class="form-control form-control-lg p-0 px-3" value="0"
                    onchange="display(this.value)">
                    <option value="0">Search Based on Link</option>
                    <option value="1">Search Based on Customer Bill ID</option>
                    <option value="2">Search Based on Customer Mobile Number</option>
                </select>
            </div>
            <div class="col-sm-3 form-group" id="0">
                <label for="lid">Link ID</label>
                <input type="text" id="lid" name="link" class="form-control form-control-lg p-0 px-3">
            </div>
            <div class="col-sm-3 form-group" id="1" style="display: none;">
                <label for="billid">Bill ID</label>
                <input type="text" id="billid" name="bill_id" class="form-control">
            </div>
            <div class="col-sm-3 form-group" id="2" style="display: none;">
                <label for="mobile">Mobile Number</label>
                <input type="text" id="mobile" name="mobile" class="form-control form-control-lg p-0 px-3">
            </div>
            <div class="col-sm-2 form-group">
                <br>
                <center><input type="submit" value="Submit" class="btn btn-primary" required></center>
            </div>
        </div>
    </form>
    {% if obj %}
    <div class="container mt-5 p-4 bg-gradient" style="background-color: rgb(226, 233, 240); border-radius: 30px;
    background: #d9e1e9;
    box-shadow:  20px 20px 60px #c0c6cc,
                 -20px -20px 60px #ffffff;">
        <p class="text-center mb-4" style="font-size: xx-large; font-weight: 600; color: #002366;">Customer Details</p>
        <p style="font-size: larger; color: #002366; font-weight: 500;">Coupons</p>
        <table class="table table-striped table-bordered table-hover" style="overflow-x: auto;">
            <tr>
                <th>Customer Name</th>
                <th>Bill ID</th>
                <th>Mobile Number</th>
                <th>Coupon Code</th>
                <th>Amount</th>
                <th>Date Created</th>
                <th>Created At Branch</th>
                <th>Scratched</th>
                <th>Redeemed</th>
                <th>Redeemed Date</th>
            </tr>
            {%for item in obj%}
            <tr>
                <td>{{item.coupon.first.name}}</td>
                <td>{{item.coupon.first.bill_id}}</td>
                <td>{{item.coupon.first.mobile}}</td>
                <td>{{item.code}}</td>
                <td>{{item.amount}}</td>
                <td>{{item.coupon.first.date_created}}</td>
                <td>{{item.coupon.first.created_by.branch}}</td>
                <td>{{item.scratched}}</td>
                <td>{{item.redeemed}}</td>
                <td>{{item.redeemed_date}}</td>
            </tr>
            {%endfor%}
        </table>
    </div>

</div>
{%endif%}
<script>
    function display(val) {
        switch (val) {
            case "0": document.getElementById('0').style.display = 'block';
                document.getElementById('1').style.display = 'none';
                document.getElementById('2').style.display = 'none';
                break;
            case "1": document.getElementById('0').style.display = 'none';
                document.getElementById('1').style.display = 'block';
                document.getElementById('2').style.display = 'none';
                break;
            case "2": document.getElementById('0').style.display = 'none';
                document.getElementById('1').style.display = 'none';
                document.getElementById('2').style.display = 'block';
                break;
        }
    }
</script>
{%endblock%}